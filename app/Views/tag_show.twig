{# templates/tags/show.twig #}
{# Liste d'articles par th√©matique - Conformit√© EF-ARTICLE-04, EF-TAG-02 #}

{% extends "base.twig" %}

{% block content %}
    {# En-t√™te contextuel (EF-TAG-02) #}
    <div class="d-flex align-items-center flex-wrap mb-5 border-bottom pb-4">
        <h1 class="mb-0 me-3">{{ page_title }}</h1>
        <span class="badge bg-primary rounded-pill shadow-sm">
            {{ articles|length }} article(s) trouv√©(s)
        </span>
    </div>

    {% if articles %}
        {# Grille d'articles filtr√©s (EF-ARTICLE-04) #}
        <div class="row g-4">
            {% for article in articles %}
                <div class="col-12 col-md-6">
                    <div class="card h-100 shadow-sm border-0">
                        
                        {# Corps de carte avec flexbox pour alignement du bouton #}
                        <div class="card-body d-flex flex-column">
                            <h2 class="h5 card-title fw-bold text-primary">{{ article.titre }}</h2>
                            
                            {# Aper√ßu du contenu #}
                            <p class="card-text text-secondary small mb-3">
                                {{ article.contenu|striptags|slice(0, 150) }}...
                            </p>
                            
                            {# Navigation crois√©e : autres tags de l'article #}
                            {% if article.tags %}
                                <div class="mb-3">
                                    {% for other_tag in article.tags %}
                                        {# On peut mettre en √©vidence le tag actuel diff√©remment #}
                                        <span class="badge {{ other_tag.id == tag.id ? 'bg-primary' : 'bg-light text-secondary border' }} me-1">
                                            {{ other_tag.nom_tag }}
                                        </span>
                                    {% endfor %}
                                </div>
                            {% endif %}
                            
                            <a href="/3A2526-Blog/public/post/{{ article.id }}" class="btn btn-outline-primary btn-sm mt-auto w-50">
                                Lire l'article
                            </a>
                        </div>
                        
                        {# M√©tadonn√©es (EF-ARTICLE-03) #}
                        <div class="card-footer bg-transparent border-top-0 text-muted small">
                            üìÖ {{ article.date_creation|date("d/m/Y") }} par <strong>{{ article.nom_utilisateur }}</strong>
                        </div>
                    </div>
                </div>
            {% endfor %}
        </div>
    {% else %}
        {# Feedback utilisateur en cas de cat√©gorie vide #}
        <div class="alert alert-light text-center py-5 border shadow-sm">
            <h4 class="text-muted">Aucun article trouv√©</h4>
            <p class="mb-0">Il n'y a pas encore de contenu publi√© sous la th√©matique "{{ tag.nom_tag }}".</p>
        </div>
    {% endif %}

    {# Navigation de retour contextuelle #}
    <div class="mt-5 pt-3">
        <div class="btn-group shadow-sm">
            <a href="/3A2526-Blog/public/tags" class="btn btn-outline-secondary">‚Üê Toutes les th√©matiques</a>
            <a href="/3A2526-Blog/public/" class="btn btn-secondary">Accueil</a>
        </div>
    </div>
{% endblock %}